## Exploratory Data Analysis {.page_break_before}

Open-source crash data is published by the Illinois Department of Transportation (IDOT) yearly. Each crash report was found to have extensive entries with up to 85 attributes, which include several independent variables to describe each occurence. Each dataset is organized with observations filled out according to the IDOT Traffic Crash Report SR 1050 Instruction Manual (2019). The datasets for each year are available online in .CSV format at the IDOT website, and they contain observations arranged in rows and attributes in columns. The datasets from 2017, 2018, and 2019 were included in this Exploratory Data Analysis. The datasets from 2020 and 2021 were discarded in this analysis given the COVID-19 pandemic outbreak, which altered drastically the dynamics of traffic worldwide, and thus crash-related data (Yasin, Grivna & Abu-Zidan, 2021). Regarding the dataset size, each one had originally over 300,000 rows (944,328 in total, combined).
The Exploratory Data Analysis will be carried out following the steps described in the next sections.

### Reading the Data

The datasets were imported to Visual Studio Code using the CSV library. It was found that the latest report contained 5 additional attributes that could not be used since they were missing in previous reports. It was verified that any other attribute was arranged in the same way for each file, thus it was decided to discard this information. After deleting these attributes, all 03 datasets were merged into a unified file, which contains 80 variables (columns) and 944,328 observations (rows). This final database serves as the baseline to start the cleaning process.

### Cleaning Process

It was found that several independent variables would not provide fruitful information due to missing, unknown or incomplete data. First, this observation was obtained by visual inspection, and later by analyzing the number of different and unique values present in each attribute. Thus, the datasets were processed to filter out irrelevant or incomplete variables. For instance, information pertaining the location (latitude & longitude, or X & Y coordinates) have not been taken into account. A map plot was initially produced to see the distribution of the data though. Columns containing codes describing the city, county or ID of the location where the crash took place have also been excluded. Columns involving duplicate information (e.g. two columns describing the same independent variable with a label and a number), and traffic structures were also removed. For few other independent variables, information that could potentially be useful was found to be significantly incomplete. For instance, this was the case of attributes such as the number of lanes and the type of intersection. As a consequence, these variables were not included on the clean dataset. Finally, additional cleaning was carried out for independent variables with a high number of description labels. For example, the "Railroad Crossing Number" variable had up to 100 different values which would have not been handy information for the end-user. After filtering out all the attributes that would not be utilized for this analysis, the number of independent variables went down from 80 to 21.

When it comes to crash reports, several inconsistencies are considerably frequent. In the literature, for example, it is mentioned that "investigation of traffic safety by means of crash records is a reactive approach, where researchers need to deal with imprecise, incomplete, inconsistent, and, sometimes, inexistent records", and thats why the acquisition of historical series to provide minimal consistency to the analysis of crashes to reduce misinterpretations and misleading conclusions is crucial (Hauer & Hakkert, 1989; Chin & Quek, 1997; Farmer, 2003). This justifies the need of dedicating a considerable amount of time, after filtering the columns (variables) of interest, to the cleaning process of the rows (observations). For each column, the observations labeled as "blank", "unknown", and "other" were matter of discussion among the group on how these inconsistencies would be handled. For all variables, the "blank" observations were immediately removed from the dataset. 


### Analysis and Visualization

In this section, a set of plots, charts and visuals are presented to present some of the findings of the exploratory data analysis. Certain conditions that were identified as more significant are displayed in the graphs below

#### Bar Plot Crashes

![
**Bar Plot Historical Crashes.**
Crash reports from 2017 in the state of Illinois, USA.
]( https://user-images.githubusercontent.com/112973190/198912087-2713cf8e-9bff-48d8-92c9-4eaa55ab5f13.png "crash_2017"){#fig:crash-2017}

For 2017, the month with the most incidents is December (“12”), with 28032 car crashes (out of 295651 for that year), and the month with the least car crashes is February (“2”), with 20049 incidents that month. These findings can represent the effect of weather conditions as well, given that during the very first and the later years of the year, the amount of accidents increases. These months correspond to winter season, and englobes certain holidays where people might be very active and potentially more car crashes might happen.


![
**Bar Plot Historical Crashes.**
Crash reports from 2018 in the state of Illinois, USA.
]( https://user-images.githubusercontent.com/112973190/198912109-91307e17-fc48-4708-b7db-594f47e67e57.png "crash_2018"){#fig:crash-2018}

Now, for 2018, different from the previous year, the month with the largest count of accidents is November (“11”), with 28743 recorded crashes (out of 304196). The month with the least amount of crashes is March (“3”), with 22200 crashes. For this year, just like for 2017, the months were peaks happen can be associated to the worse seasons for a driver.


![
**Bar Plot Historical Crashes.**
Crash reports from 2019 in the state of Illinois, USA.
]( https://user-images.githubusercontent.com/112973190/198912124-1cba7a7a-5429-475b-9f49-93e684e18740.png "crash_2019"){#fig:crash-2019}

For the year 2019, the month with most accidents is November (“11”), with 26964 recorded crashes (out of 283946), and the month with the least accidents is March (“3”), with 20569 incidents. in a similar way to years 2017 and 2018, the months with the highest count happen in the same season. 


#### Map

![
**Distribution of crash occurrences.**
Crash reports from 2017,2018,2019 in the state of Illinois, USA.
]( https://user-images.githubusercontent.com/63623246/198847704-2128a33e-4ecb-4155-a802-e60878d1f137.png "Mapinha"){#fig:map-ihna}

Using the “X” and “Y” information present in the dataset, a visual distribution of the location of the recorded car crashes is illustrated in the map Figure. In the map of Illinois, the red dots represent a pair of “X” and “Y” coordinates, being the location where a car crash happened. The majority of car crashes appear to had happened in cities and towns. The best example would be Chicago, where all around the area, the number of occurrences, or red dots, is significantly higher, which may be presumable given that Chicago and the surrounding areas host a big fraction of the state’s population. In a smaller scale, this is also visible that in other cities and towns, such as Springfield and Davenport. In other locations, the recorded car crashes are much more spaced out, with certain “hotspots” in some highways and roads. 


#### Pie Chart | Lightning Conditions

![
**Distribution of accidents by Lightning Condition.**
From 2017 to 2019.
]( https://user-images.githubusercontent.com/112973190/198851767-816066d7-66ee-4aea-acea-d27d3ce12fe7.png "Light_cond"){#fig:lightning-cond}

This figure displays the different percentages of the different lighting conditions presented in the dataset. The condition with the most car crashes associated to it is “Daylight”, representing a 66% of the crashes in the dataset. During night time, “Darkness/Lighted Road” accounts for 18% of the crashes and “Darkness”, 11%. Conditions “Dawn” and “Dusk” account for 2% each of the car crashes recorded.


#### Pie Chart |Road Surface Condition

![
**Distribution of accidents by Road Surface Condition.**
From 2017 to 2019.
]( https://user-images.githubusercontent.com/112973190/198915863-f53ee251-18bb-4c60-8c64-8315ef08ee9f.png "surf-cond"){#fig:surf-cond}

The chart above summarizes the analysis performed on the data on the influence of the road surface condition on the amount of car crashes. It was found that 76% of the recorded crashes correspond to a “dry” road surface, which can be thought of as the least dangerous condition. For the not too favorable road surface conditions, 16% of the car crashes analyzed correspond to a “wet” road surface, 5% to “snow”, 2% to “ice” and other “unknown” road surface conditions.


#### Bar Plot | Road Defects
![
**Distribution of accidents by Road Defects.**
From 2017 to 2019.
]( https://user-images.githubusercontent.com/112973190/198915785-44a4248e-d9b5-4dbb-adfd-4349b6e764d4.png "road-def") {#fig:road_def}

This figure shows the number of car crashes associated with the different Road Defects. The horizontal axis labels the road defects from the data, and the vertical axis accounts for the number of observations. As seen in the bar chart, the vast majority of the incidents (808,835 out of 883,793 observations, which accounts for a 91.52%) happened where “no defects” were present in the location. The following condition of road defects is “unknown”, accounting for a 6.61% of accidents. Now, the percentage of observations where defects were reported are 0.5% for “worn surface” and “other road defects”, 0.14% for “shoulder” road defects, 0.49% for debris on roadways, and 0.21% for “ruts and holes”.

![
**Distribution of accidents by Road Defects,**
excluding No Defects condition
](https://user-images.githubusercontent.com/112973190/198915622-972e8402-da22-4a13-99fe-6995ee936c70.png "road_def_excl"){#fig:road-excl}

Given that a great number of crashes happened without any road defects, it might be interested to account for the likelihood of road defects to be associated with a car crash. Figure X displays the different percentages of the road defects accounted for in the dataset, where “unknown” represents 78% of the data, followed by a 6% for “worn surfaces”, “debris on roadway” and “other” road defects, and 2% for “ruts and holes” and “shoulder” defects. 





#### Bar Plot

![
**Distribution of accidents over time.**
From 2017 to 2019.
](https://user-images.githubusercontent.com/112973190/198916592-12348b8d-af9f-47f6-8bad-c0deb7819bec.jpeg "over_time"){#fig:over-time}


#### Correlation Plot
|                               | Association with CrashSeverity         
|:------------------------------|:-------------:|
| CrashYr                       | 0.00807       |
| CrashMonth                    | 0.0268889     | 
| CrashDay                      | 0.00470057    |
| NumberOfVehicles              | 0.101171      | 
| DayOfWeekCode                 | 0.0110936     |
| CrashHour                     | 0.0255177     | 
| CollisionTypeCode             | 0.259482      | 
| TotalFatals                   | 0.707104      | 
| TotalInjured                  | 0.705812      | 
| NoInjuries                    | 0.355953      | 
| CrashSeverity                 | 1             | 
| IntersectionRelated           | 0.141338      |
| RoadwayFunctionalClassCode    | 0.0714974     | 
| WorkZoneRelated               | 0.00473353    | 
| TypeOfFirstCrash              | 0.259498      | 
| CityName                      | 0.0738726     | 
| ClassOfTrafficWay             | 0.0608374     | 
| Cause1                        | 0.165848      | 
| TrafficControlDevice          | 0.097696      |
| TrafficControlDeviceCond      | 0.0515391     | 
| RoadSurfaceCond               | 0.0329927     | 
| RoadDefects                   | 0.0424504     |
| LightingCond                  | 0.02852       | 
| WeatherCond                   | 0.0307212     | 


As mentioned earlier, one of the objectives of analyzing this data is understanding how different road and environment conditions would affect crashes and their severity. This can be obtained by finding the associations between the different variables (columns) in the dataset, meaning how is one variable affected by the other.
However, most of the variables are of categorical type, i.e., variables that are identified based on names or labels given to them and not based on numbers. This makes the built-in correlation functions in Python or Julia not helpful. One very commonly used method to measure the correlation between two categorical variables is Cramer’s V statistic. Cramer’s V is based on a nominal variation of Pearson’s Chi-Square Test. Like correlation, the output takes values between 0 and 1 (inclusive), with 0 corresponding to no correlation between the variables and 1 corresponding to one variable being completely determined by the other. On the other hand, and unlike the usual correlation, there are no negative values.
For this project, a function was created in Python that calculates the association between any 2 categorical columns using confusion matrix which can be obtained via built-in pandas method for categorical columns (pd.crosstab).
For this data that has 24 columns, running this function for every pair of variables would take too much time and may not give many insights. Therefore, the function was used to find how the column “CrashSeverity” is correlated with every other variable. This column was chosen because finding how different conditions affect the severity of the crash is one of the most important outcomes of studying this dataset, and this would give an idea about the variables that have a significant impact on the crashes.

The output is described in the table below:


### Trends

Since not all the variables have to be present for an accident to occur, it can be seen that most accidents happen in the absence of adverse conditions. However, we should take into account that this reflects the fact that adverse conditions are exceptions, and accidents happen on a daily basis with other factors as underlying reasons such as human behavior. However, adverse conditions do increase the likelihood of accidents and it can be observed an increase in the overall number of occurrences in specific hours (evening), days (weekends), and months (winter).The road type is also found to be directly correlated with the maximum speed limit, and as a consequence is tied to the number of accidents per day.


### Potential Issues

As long as the number of entries containing a value for an independent variable overcome by large any other value for the same independent variable, we may experience problems related to "imbalanced data" due to the uneven distribution of observations.
Similarly, it can be seen that most of the independent variables are "classifications", and therefore their entries don't provide meaningul numerical values to be analized or correlated. For some of them we could replace the text values by boolean variables, but for some others a rating system may be needed if a numerical interpretation is required. 

It can be noticed that most of the attributes are subjective observations trying to describe the potential causes of an accident, and may be dependent on the observer itself. However, the casualties are a meaningful numerical observation that will be thoroughly used througout this report.
